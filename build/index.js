"use strict";function searchPageTitle(e,t,s,r){var a={action:"query",format:"json",prop:"extracts|pageimages",exchars:300,explaintext:"true",exintro:"true",piprop:"thumbnail",pithumbsize:300,titles:e[t]};$.ajax({url:"https://en.wikipedia.org/w/api.php",dataType:"jsonp",data:a,success:function(a){var n=a.query.pages;$.map(n,function(s){var r=$('<div class="result">'),a="https://en.wikipedia.org/wiki/"+e[t].replace(/ /g,"_");if(r.append($("<h2>").html('<a class="wiki-serif" target="_blank" rel="noopener noreferrer" href="'+a+'">'+e[t]+"</a>")),s.thumbnail){var n=$('<div class="result-thumbnail-container">');r.append(n.append($('<img class="result-thumbnail">').attr("src",s.thumbnail.source)))}r.append($("<p>").html(s.extract)),r.append($('<hr class="hr-result">')),batchResults.append(r)}),t!=s-1?searchPageTitle(e,t+1,s):(r||$(".hr-result").show(),$("#search-results").append(batchResults),$(".hr-result").last().hide(),$("#loading-new").hide(),$("#loading-more").hide(),$("#txt-search").autocomplete("close"),$("#results-container").fadeIn(),""!=continueSettings?$("#btn-more").show():$("#btn-more").hide())},error:function(e){console.log(e)}})}function searchPageTitles(e,t){var s=0,r=e.length;$("#txt-search").autocomplete("close"),batchResults=$('<div class="batch-results">'),searchPageTitle(e,s,r,t)}function searchWiki(e,t){$("#btn-more").hide(),$("#no-results").hide();var s={action:"query",format:"json",redirects:"true",list:"search",srsearch:e,srlimit:10,"continue":continueSettings,sroffset:sroffsetSettings};t?(s["continue"]="",s.sroffset="",$("#results-container").hide(),$("#search-results").html(""),$("#loading-new").show()):$("#loading-more").show();var r=[];$.ajax({url:"https://en.wikipedia.org/w/api.php",dataType:"jsonp",data:s,success:function(s){var a=s.query.search;0!=a.length?($.map(a,function(e){r.push(e.title)}),previousSearch=e,void 0!=s["continue"]?(continueSettings=s["continue"]["continue"],sroffsetSettings=s["continue"].sroffset):(continueSettings="",sroffsetSettings=""),searchPageTitles(r,t)):($("#loading-new").hide(),$("#no-results").show())},error:function(e){console.log(e)}})}var previousSearch="",continueSettings="",sroffsetSettings="",batchResults=null;$(document).ready(function(){$("#btn-search").on("click",function(e){var t=$("#txt-search").val();if(""!=t)return $("#txt-search").autocomplete("close"),searchWiki(t,!0),!1}),$("#txt-search").keypress(function(e){var t=$("#txt-search").val();if(""!=t&&13==e.which)return $("#txt-search").autocomplete("close"),searchWiki(t,!0),!1}),$("#btn-more").on("click",function(e){searchWiki(previousSearch,!1)}),$("#txt-search").autocomplete({source:function(e,t){var s={action:"opensearch",format:"json",search:e.term};$.ajax({url:"https://en.wikipedia.org/w/api.php",dataType:"jsonp",data:s,success:function(e){t(e[1])},error:function(e){t([])}})}})});